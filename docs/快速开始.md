# 2DGS å¿«é€Ÿå¼€å§‹æŒ‡å—

## ä¸€é”®å¼è‡ªåŠ¨ Pipeline (æ¨è ğŸš€)

å¦‚æœä½ æœ‰ä¸€ä¸ªè§†é¢‘ï¼Œæƒ³ç›´æ¥å¾—åˆ°æ¨¡å‹ï¼Œå¯ä»¥ä½¿ç”¨æœ¬é¡¹ç›®é›†æˆçš„å…¨è‡ªåŠ¨è„šæœ¬ã€‚å®ƒä¼šè‡ªåŠ¨å®ŒæˆæŠ½å¸§ã€ä½å§¿è®¡ç®—ã€å»ç•¸å˜å’Œè®­ç»ƒï¼Œå¹¶**è‡ªåŠ¨æ£€æµ‹ COLMAP æ˜¯å¦æˆåŠŸ**ï¼Œå¤±è´¥åˆ™æŠ¥é”™åœæ­¢ã€‚

```bash
# ç”¨æ³•: ./full_pipeline.sh <è§†é¢‘è·¯å¾„> <åœºæ™¯åç§°> [å¯é€‰:è¿­ä»£æ¬¡æ•°]
./full_pipeline.sh ~/projects/Sparse2DGS/video.mp4 my_video 30000
```

---

## æ‰‹åŠ¨åˆ†å¸ƒæ‰§è¡Œ (å®Œæ•´æµç¨‹)

### 1. å‡†å¤‡è§†é¢‘
```bash
cd ~/projects/2d-gaussian-splatting
mkdir -p data/my_video/images
ffmpeg -i ~/projects/Sparse2DGS/video.mp4 -vf "fps=2,scale=1920:-2" data/my_video/images/%04d.jpg
```

### 2. COLMAP/GLOMAP å¤„ç†
```bash
conda activate gs_linux_backup
cd data/my_video

# ç‰¹å¾æå–ï¼ˆGPU åŠ é€Ÿï¼‰
colmap feature_extractor --database_path database.db --image_path images

# ç‰¹å¾åŒ¹é…ï¼ˆGPU åŠ é€Ÿï¼‰
colmap exhaustive_matcher --database_path database.db

# ç¨€ç–é‡å»ºï¼ˆä½¿ç”¨ GLOMAP å…¨å±€é‡å»ºï¼Œé€Ÿåº¦æ›´å¿«ï¼‰
colmap global_mapper --database_path database.db --image_path images --output_path sparse

# å›¾åƒå»ç•¸å˜ï¼ˆç”Ÿæˆ PINHOLE ç›¸æœºï¼‰
mkdir -p sparse_undistorted
colmap image_undistorter \
    --image_path images \
    --input_path sparse/0 \
    --output_path sparse_undistorted \
    --output_type COLMAP

# âš ï¸ å…³é”®æ­¥éª¤ï¼š2DGS è¦æ±‚ä½å§¿æ–‡ä»¶åœ¨ sparse/0 ç›®å½•ä¸‹
mkdir -p sparse_undistorted/sparse/0
mv sparse_undistorted/sparse/*.bin sparse_undistorted/sparse/0/ 2>/dev/null || true
```

**âš ï¸ é‡è¦ï¼šGLOMAP (global_mapper) é€šå¸¸æ¯”æ™®é€šçš„å¢é‡å¼é‡å»º (mapper) æ›´å¿«ï¼Œä¸”åœ¨æŸäº›åœºæ™¯ä¸‹æ›´ç¨³å¥ã€‚**

### 3. è®­ç»ƒ 2DGS
```bash
cd ~/projects/2d-gaussian-splatting

# è®­ç»ƒ
python train.py -s data/my_video/sparse_undistorted -m output/my_video
```

**è®­ç»ƒå‚æ•°ï¼š**
- `-s`: æ•°æ®é›†è·¯å¾„
- `-m`: è¾“å‡ºæ¨¡å‹è·¯å¾„
- `--iterations`: é»˜è®¤ 30000 æ¬¡è¿­ä»£
- `--lambda_normal 0.05`: æ³•å‘æ­£åˆ™åŒ–ï¼ˆæé«˜å‡ ä½•è´¨é‡ï¼‰
- `--lambda_distortion 0.01`: æ·±åº¦ç•¸å˜æ­£åˆ™åŒ–

### 4. æ¸²æŸ“å’Œå¯è§†åŒ–
```bash
# æ¸²æŸ“æµ‹è¯•é›†
python render.py -s data/my_video/sparse_undistorted -m output/my_video

# å®æ—¶æŸ¥çœ‹è®­ç»ƒè¿‡ç¨‹
python view.py -s data/my_video/sparse_undistorted -m output/my_video
```

---

## è®­ç»ƒè¿›åº¦

è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šæ˜¾ç¤ºï¼š
- **è¿›åº¦æ¡**ï¼š`Training progress: 23%|â–ˆâ–ˆâ–`
- **è¿­ä»£æ•°**ï¼š`7000/30000`
- **æŸå¤±**ï¼š`Loss=0.04840`
- **ç‚¹æ•°**ï¼š`Points=1363948`
- **é€Ÿåº¦**ï¼š`3.50it/s`

**é¢„è®¡æ—¶é—´**ï¼š~30-60 åˆ†é’Ÿï¼ˆ30000 æ¬¡è¿­ä»£ï¼‰

---

## æŸ¥çœ‹è®­ç»ƒå¥½çš„æ¨¡å‹

### æ–¹æ³• 1ï¼šä½¿ç”¨ view.pyï¼ˆæ¨èï¼‰
```bash
python view.py -s data/my_video/sparse_undistorted -m output/my_video
```
- æ”¯æŒé¼ æ ‡æ‹–æ‹½æ—‹è½¬
- å®æ—¶æ¸²æŸ“
- GPU åŠ é€Ÿ

### æ–¹æ³• 2ï¼šä½¿ç”¨ SIBR Viewer
```bash
# 1. å¯åŠ¨ SIBR Viewer
<path_to_viewer>/bin/SIBR_remoteGaussian_app_rwdi

# 2. æˆ–è€…åœ¨è®­ç»ƒæ—¶è‡ªåŠ¨è¿æ¥
python view.py -s data/my_video/sparse_undistorted -m output/my_video
```

### æ–¹æ³• 3ï¼šæ¸²æŸ“å›¾ç‰‡
```bash
# æ¸²æŸ“æ‰€æœ‰è§†è§’
python render.py -s data/my_video/sparse_undistorted -m output/my_video

# æŸ¥çœ‹æ¸²æŸ“ç»“æœ
ls output/my_video/train/  # è®­ç»ƒé›†æ¸²æŸ“
ls output/my_video/test/   # æµ‹è¯•é›†æ¸²æŸ“
```

---

## æå–ç½‘æ ¼æ¨¡å‹ï¼ˆå¯é€‰ï¼‰

### æœ‰ç•Œç½‘æ ¼ï¼ˆé€‚åˆå®¤å†…ã€å‰æ™¯ç‰©ä½“ï¼‰
```bash
python render.py \
    -s data/my_video/sparse_undistorted \
    -m output/my_video \
    --mesh_res 512 \
    --skip_test --skip_train
```

### æ— ç•Œç½‘æ ¼ï¼ˆé€‚åˆå®¤å¤–å¤§åœºæ™¯ï¼‰
```bash
python render.py \
    -s data/my_video/sparse_undistorted \
    -m output/my_video \
    --unbounded \
    --mesh_res 1024 \
    --skip_test --skip_train
```

**è¾“å‡º**ï¼š`output/my_video/mesh.ply`

---

## å¸¸è§é—®é¢˜

### Q: è®­ç»ƒä¸­æ–­äº†æ€ä¹ˆåŠï¼Ÿ
```bash
# ä»æ–­ç‚¹æ¢å¤ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
python train.py -s data/my_video/sparse_undistorted -m output/my_video --start_checkpoint output/my_video/chkpnt7000.pth
```

### Q: å¦‚ä½•å‡å°‘è®­ç»ƒæ—¶é—´ï¼Ÿ
```bash
# å‡å°‘è¿­ä»£æ¬¡æ•°
python train.py -s data/my_video/sparse_undistorted -m output/my_video --iterations 15000
```

### Q: COLMAP å¤ªæ…¢æ€ä¹ˆåŠï¼Ÿ
å‡å°‘å›¾ç‰‡æ•°é‡ï¼š
```bash
ffmpeg -i video.mp4 -vf "fps=1,scale=1280:-2" images/%04d.jpg
```

---

## å®Œæ•´ç¤ºä¾‹ï¼ˆä»è§†é¢‘åˆ°æ¨¡å‹ï¼‰

```bash
# 1. æ¿€æ´»ç¯å¢ƒ
conda activate gs_linux_backup

# 2. è¿›å…¥é¡¹ç›®
cd ~/projects/2d-gaussian-splatting

# 3. å‡†å¤‡æ•°æ®
mkdir -p data/my_video/images
ffmpeg -i ~/projects/Sparse2DGS/video.mp4 -vf "fps=2,scale=1920:-2" data/my_video/images/%04d.jpg

# 4. COLMAP ç‰¹å¾æå–
cd data/my_video
colmap feature_extractor --database_path database.db --image_path images

# 5. COLMAP ç‰¹å¾åŒ¹é…
colmap exhaustive_matcher --database_path database.db

# 6. GLOMAP å…¨å±€é‡å»ºï¼ˆé€Ÿåº¦æ›´å¿«ï¼‰
colmap global_mapper --database_path database.db --image_path images --output_path sparse

# 7. å›¾åƒå»ç•¸å˜å¹¶æ•´ç†ç›®å½•
mkdir -p sparse_undistorted
colmap image_undistorter --image_path images --input_path sparse/0 --output_path sparse_undistorted --output_type COLMAP
mkdir -p sparse_undistorted/sparse/0
mv sparse_undistorted/sparse/*.bin sparse_undistorted/sparse/0/ 2>/dev/null || true

# 8. è®­ç»ƒ 2DGSï¼ˆå›åˆ°é¡¹ç›®ç›®å½•ï¼‰
cd ~/projects/2d-gaussian-splatting
python train.py -s data/my_video/sparse_undistorted -m output/my_video

# 9. æŸ¥çœ‹æ¨¡å‹
python view.py -s data/my_video/sparse_undistorted -m output/my_video
```

**æ€»æ—¶é—´**ï¼š30-90 åˆ†é’Ÿ
- GLOMAPï¼š5-15 åˆ†é’Ÿ
- è®­ç»ƒï¼š20-60 åˆ†é’Ÿ

---

## ç›¸å…³æ–‡ä»¶ä½ç½®

- **æ•°æ®**ï¼š`~/projects/2d-gaussian-splatting/data/my_video/`
- **æ¨¡å‹**ï¼š`~/projects/2d-gaussian-splatting/output/my_video/`
- **æ—¥å¿—**ï¼š`output/my_video/cfg_args`
- **æ¸²æŸ“ç»“æœ**ï¼š`output/my_video/train/` æˆ– `output/my_video/test/`

---

**æœ€åæ›´æ–°**ï¼š2026-02-16
**ä½ çš„ fork**ï¼šhttps://github.com/tianxingleo/2d-gaussian-splatting
